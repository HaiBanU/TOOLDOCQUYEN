/* --- START OF FILE public/css/analysis.css --- */

/* ================================================== */
/* === 1. CẤU HÌNH CƠ BẢN & ANIMATION GỐC === */
/* ================================================== */

@property --angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@keyframes electric-spin { to { --angle: 360deg; } }
@keyframes shoot-out {
  0% { transform: rotate(var(--angle)) translateY(var(--radius)) scaleY(0); opacity: 1; }
  60% { transform: rotate(var(--angle)) translateY(calc(var(--radius) + 80px)) scaleY(1); opacity: 1; }
  100% { transform: rotate(var(--angle)) translateY(calc(var(--radius) + 120px)) scaleY(1); opacity: 0; }
}

.analysis-page-header, 
.header.games-header {
    height: auto;
    min-height: 70px;
    padding: 10px 20px;
    background: rgba(10, 0, 0, 0.6);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    z-index: 100;
    margin-top: 0 !important;
}

/* --- CỘT TRÁI: Nút Quay Lại --- */
.header-left { flex: 0 0 auto; }
.back-button-user {
    background: rgba(255, 255, 255, 0.1);
    padding: 8px 16px;
    border-radius: 50px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #eee;
    font-size: 0.85em;
    font-weight: 600;
    text-decoration: none;
    display: flex; align-items: center; gap: 5px;
    transition: all 0.3s ease;
    white-space: nowrap;
}
.back-button-user:hover {
    background: var(--primary-red);
    border-color: var(--primary-red);
}

/* --- CỘT PHẢI: Token --- */
.header-right { flex: 0 0 auto; }
.header-right-content {
    background: linear-gradient(90deg, #a40606, #d90429);
    color: #fff;
    padding: 8px 16px;
    border-radius: 50px;
    font-weight: bold;
    font-size: 0.9em;
    box-shadow: 0 0 10px rgba(217, 4, 41, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.1);
    white-space: nowrap;
}

/* --- CỘT GIỮA: VIP --- */
.header-center {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
.user-status-row {
    margin-bottom: 4px;
    padding: 4px 15px;
    background: rgba(0, 0, 0, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 20px;
    display: inline-flex; align-items: center; justify-content: center;
}
.vip-container {
    width: 100%; max-width: 220px;
    display: flex; flex-direction: column; gap: 3px;
}
.vip-progress-track { background: #222; border: 1px solid #444; height: 4px; border-radius: 2px; overflow: hidden; }
.vip-progress-fill { height: 100%; background: linear-gradient(90deg, #00c6ff, #0072ff); box-shadow: 0 0 8px #0072ff; transition: width 0.5s ease; }
.vip-text { display: flex; justify-content: space-between; font-size: 0.7em; color: #bbb; font-family: monospace; }

/* ================================================== */
/* === MOBILE LAYOUT HEADER === */
/* ================================================== */
@media (max-width: 768px) {
    .analysis-page-header, 
    .header.games-header {
        display: grid !important;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: auto auto;
        gap: 10px 0;
        padding: 15px 10px !important;
        height: auto !important;
        box-sizing: border-box;
    }
    .header-left { grid-row: 1; grid-column: 1; justify-self: start; width: auto !important; display: flex; align-items: center; }
    .header-right { grid-row: 1; grid-column: 2; justify-self: end; width: auto !important; display: flex; align-items: center; }
    .header-center {
        grid-row: 2; grid-column: 1 / span 2;
        width: 100%; margin-top: 5px; padding-top: 10px;
        border-top: 1px dashed rgba(255,255,255,0.15);
        display: flex; flex-direction: column; align-items: center; justify-content: center;
    }
    .back-button-user { position: static !important; transform: none !important; margin: 0 !important; font-size: 0.8em; padding: 6px 12px; height: 32px; box-sizing: border-box; }
    .header-right-content { font-size: 0.8em; padding: 6px 12px; height: 32px; display: flex; align-items: center; margin: 0 !important; box-sizing: border-box; }
    .user-status-row { margin-bottom: 5px; padding: 2px 15px; font-size: 0.9em; }
    .vip-container { max-width: 90%; }
}

/* ================================================== */
/* === 3. KHUNG PHÂN TÍCH CHÍNH (MAIN FRAME) === */
/* ================================================== */

.analysis-main { flex-grow: 1; display: flex; justify-content: center; align-items: center; padding: 20px 15px; box-sizing: border-box; }

.analysis-frame { 
    width: 100%; 
    max-width: 400px;
    height: auto;
    min-height: 720px;
    background: transparent; 
    border: 2px solid var(--primary-red); 
    box-shadow: 0 0 15px var(--primary-red), inset 0 0 15px var(--primary-red); 
    padding: 0; 
    animation: fadeIn 1s, glowing-border 4s infinite ease-in-out;
    border-radius: 12px; 
    position: relative; 
    overflow: hidden;
}
.analysis-frame::before {
    content: ''; position: absolute; z-index: -1; inset: -3px;
    border-radius: 14px;
    background: conic-gradient(from var(--angle), transparent 0%, transparent 90%, #ff0000, transparent 100%);
    filter: blur(3px) drop-shadow(0 0 10px #ff0000);
    animation: electric-spin 4s linear infinite;
}

.analysis-frame-inner { 
    width: 100%; height: 100%; 
    background: rgba(0, 0, 0, 0.7); 
    display: flex; flex-direction: column; 
    position: relative; border-radius: 10px; box-sizing: border-box;
}

.analysis-content { 
    flex-grow: 1; 
    display: flex; flex-direction: column; 
    justify-content: flex-start; gap: 15px; 
    padding: 15px; 
    position: relative; z-index: 2;
}
.analysis-footer { position: relative; z-index: 2; flex-shrink: 0; padding: 15px; box-sizing: border-box; margin-top: auto; }

/* Hiệu ứng nền & Hạt */
.particle-burst { position: absolute; inset: 0; pointer-events: none; z-index: 10; }
.particle-burst > .particle { position: absolute; top: 50%; left: 50%; width: 2px; height: 30px; background: linear-gradient(to bottom, #ff4d4d, transparent); transform-origin: top center; opacity: 0; animation: shoot-out var(--duration) ease-out var(--delay) infinite; transform: rotate(var(--angle)) translateY(var(--radius)); }
#frame-wide-effects, #frame-wide-lightning { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; overflow: hidden; }

/* Title Module */
@keyframes scan-down { 0% { transform: translateY(-20px); opacity: 0; } 20% { opacity: 0.8; } 80% { opacity: 0.8; } 100% { transform: translateY(120%); opacity: 0; } }
.analysis-title-module { background: rgba(0, 0, 0, 0.5); border: 1px solid var(--primary-red); border-radius: 10px; padding: 10px 15px; text-align: center; box-shadow: 0 0 15px rgba(217, 4, 41, 0.4); position: relative; overflow: hidden; }
.analysis-title-module .scanline { position: absolute; top: 0; left: 0; width: 100%; height: 3px; background: linear-gradient(to right, transparent, rgba(255, 100, 100, 0.8), transparent); box-shadow: 0 0 10px var(--primary-red); animation: scan-down 3s linear infinite; }
.analysis-title-module h2 { margin: 0; color: #ffd700; font-size: 1.1em; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; text-shadow: 0 0 8px #ffd700; }

/* ================================================== */
/* === 4. CÁC THÀNH PHẦN VISUAL (ROBOT, SCANNER) === */
/* ================================================== */

.analysis-top-visuals { display: flex; justify-content: space-around; align-items: center; padding: 0 10px; position: relative; }
.robot-container { width: 25%; flex-shrink: 0; z-index: 5; }
#robot-image { width: 100%; max-width: 90px; animation: bot-float 3s infinite ease-in-out; }

.main-game-display { width: 150px; height: 150px; border-radius: 50%; position: relative; display: grid; place-items: center; padding: 5px; background-color: rgba(0,0,0,.5); box-shadow: 0 0 15px rgba(255,0,242,.5), inset 0 0 15px rgba(135,0,255,.5); flex-shrink: 0; }
.main-game-display::before { content: ''; position: absolute; inset: -3px; border-radius: 50%; background: conic-gradient(from var(--angle), #ff00f2, #8700ff, #00aaff, #00ffc3, #a2ff00, #ffd500, #ff00f2); animation: electric-spin 3s linear infinite; filter: blur(5px) drop-shadow(0 0 10px #8700ff); }

/* Scanner Beams */
.scanner-effects-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 4; }
.robot-to-game-scanner { position: absolute; height: 2px; background: linear-gradient(to right, #00ffff, rgba(0, 255, 255, 0)); box-shadow: 0 0 6px #00ffff; transform-origin: left center; overflow: hidden; }
.robot-to-game-scanner::after { content: ''; position: absolute; top: 0; left: -20px; width: 15px; height: 100%; background: #fff; box-shadow: 0 0 8px #fff, 0 0 12px #00ffff; animation: pulse-along-beam 2.5s linear infinite; }
@keyframes pulse-along-beam { from { left: -20px; } to { left: 110%; } }
.scanner-1 { top: 55px; left: 80px; width: 75px; transform: rotate(-25deg); }
.scanner-2 { top: 75px; left: 80px; width: 90px; transform: rotate(0deg); animation-delay: 0.3s; }
.scanner-3 { top: 95px; left: 80px; width: 75px; transform: rotate(25deg); animation-delay: 0.6s; }
.scanner-2::after, .scanner-3::after { animation-delay: inherit; }

/* Glitch Image */
.glitch-wrapper { width: 100%; height: 100%; border-radius: 50%; overflow: hidden; position: relative; z-index: 2; border: 2px solid #fff; }
#panel-game-image { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; position: relative; z-index: 1; }
.glitch-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; border-radius: 50%; z-index: 2; }
.glitch-layer:nth-child(2) { background: repeating-linear-gradient(rgba(0,0,0,0.5) 0px, rgba(0,0,0,0.5) 1px, transparent 1px, transparent 4px); background-size: 100% 4px; opacity: 0.3; animation: scanlines-move 2s linear infinite; }
.glitch-layer:nth-child(3) { background-color: rgba(217, 4, 41, 0.3); mix-blend-mode: color-dodge; animation: glitch-flicker 3s linear infinite; }
@keyframes scanlines-move { from { background-position: 0 0; } to { background-position: 0 -8px; } }
@keyframes glitch-flicker { 0%, 100% { clip-path: inset(0); } 10% { clip-path: inset(90% 0 5% 0); } 11% { clip-path: inset(0); } 40% { clip-path: inset(10% 0 85% 0); } 41% { clip-path: inset(0); } 70% { clip-path: inset(80% 0 10% 0); } 71% { clip-path: inset(0); } 94% { clip-path: inset(5% 0 90% 0); } 95% { clip-path: inset(0); } }
.scan-impact-ripple { position: absolute; top: -5px; left: -5px; width: calc(100% + 10px); height: calc(100% + 10px); border: 2px solid #00ffff; border-radius: 50%; z-index: 5; opacity: 0; animation: ripple-effect 2.5s linear infinite; }
.scan-impact-ripple::after { content: ''; position: absolute; top: -4px; left: -4px; width: calc(100% + 8px); height: calc(100% + 8px); border: 2px solid #00ffff; border-radius: 50%; animation-delay: 0.2s; }
@keyframes ripple-effect { 0% { transform: scale(0.9); opacity: 0; } 80% { transform: scale(0.9); opacity: 0; } 90% { transform: scale(1); opacity: 0.8; } 100% { transform: scale(1.1); opacity: 0; } }

/* ================================================== */
/* === 5. PROGRESS FRAME (ĐÃ CHỈNH SỬA KÍCH THƯỚC) === */
/* ================================================== */

.progress-frame-container { 
    /* Desktop: Điều chỉnh kích thước nhỏ lại */
    width: 110px; 
    height: 110px; 
    position: relative; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    margin: 0 15px; 
    flex-shrink: 0; 
}

.progress-frame-img { 
    width: 100%; 
    height: 100%; 
    position: absolute; 
    top: 0; left: 0; 
    animation: spin-frame 6s linear infinite; 
    /* Filter màu đỏ cơ khí */
    filter: sepia(100%) saturate(500%) hue-rotate(-50deg) drop-shadow(0 0 10px #ff3300); 
    z-index: 1; 
    opacity: 0.95; 
}

/* --- STYLE CHO SỐ PHẦN TRĂM (%) --- */
.progress-frame-value { 
    font-family: 'Orbitron', sans-serif; 
    /* Desktop: Cỡ chữ vừa phải */
    font-size: 1.8em; 
    font-weight: 900; 
    
    /* Màu xanh Neon nổi bật (Green) */
    color: #00ff8c; 
    
    z-index: 2; 
    position: relative; 
    letter-spacing: 1px;
    
    /* Hiệu ứng bóng đổ xanh để nổi trên nền đỏ */
    text-shadow: 
        0 0 5px #fff,
        0 0 15px #00ff8c, 
        0 0 25px #00b894; 
    
    animation: text-pulse-green 2s infinite ease-in-out; 
}

/* Animation xoay vòng tròn */
@keyframes spin-frame { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* Animation số (Màu xanh) */
@keyframes text-pulse-green { 
    0%, 100% { transform: scale(1); opacity: 1; } 
    50% { transform: scale(1.05); opacity: 1; } 
}

/* Khi kết thúc/Failed thì chuyển màu đỏ */
.progress-frame-value.end-state { 
    color: #ff0000 !important; 
    text-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000 !important; 
    animation: alarm-pulse 0.4s infinite alternate !important; 
}

@keyframes alarm-pulse { 
    from { transform: scale(1); filter: brightness(1); } 
    to { transform: scale(1.1); filter: brightness(1.5); } 
}

/* ================================================== */
/* === 6. POPUP 3D "SCATTER/BOSS ĐÃ NỔ" (MỚI) === */
/* ================================================== */

.scatter-popup-overlay {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(5px);
    display: flex; justify-content: center; align-items: center;
    z-index: 999; animation: fadeInOverlay 0.3s ease-out;
    border-radius: 12px; overflow: hidden;
}
@keyframes fadeInOverlay { from { opacity: 0; } to { opacity: 1; } }

/* Tia sáng xoay */
.sunburst-bg {
    position: absolute; width: 200%; height: 200%;
    background: conic-gradient(from 0deg, transparent 0deg, rgba(255, 215, 0, 0.1) 20deg, transparent 40deg, rgba(255, 215, 0, 0.1) 60deg, transparent 80deg, rgba(255, 215, 0, 0.1) 100deg, transparent 120deg, rgba(255, 215, 0, 0.1) 140deg, transparent 160deg, rgba(255, 215, 0, 0.1) 180deg, transparent 200deg, rgba(255, 215, 0, 0.1) 220deg, transparent 240deg, rgba(255, 215, 0, 0.1) 260deg, transparent 280deg, rgba(255, 215, 0, 0.1) 300deg, transparent 320deg, rgba(255, 215, 0, 0.1) 340deg, transparent 360deg);
    animation: rotateSunburst 10s linear infinite; z-index: -1;
}
@keyframes rotateSunburst { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

.scatter-popup-content {
    background: radial-gradient(circle, #2b0505 0%, #000000 100%);
    border: 2px solid #ffd700; padding: 30px 50px; border-radius: 16px;
    text-align: center;
    box-shadow: 0 0 50px rgba(255, 215, 0, 0.4), inset 0 0 20px rgba(255, 0, 0, 0.3);
    transform: scale(0.8);
    animation: popInScatter 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    position: relative;
}
@keyframes popInScatter { to { transform: scale(1); opacity: 1; } }

.scatter-icon { font-size: 3em; margin-bottom: 10px; filter: drop-shadow(0 0 10px #ffd700); animation: bounceIcon 1s infinite; }
@keyframes bounceIcon { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

.scatter-text-main {
    font-family: 'Poppins', sans-serif; font-size: 2.2em; font-weight: 900;
    text-transform: uppercase;
    background: linear-gradient(to bottom, #fff 0%, #ffd700 50%, #ff8c00 100%);
    -webkit-background-clip: text; background-clip: text; color: transparent;
    filter: drop-shadow(0 0 5px rgba(255, 140, 0, 0.8));
    animation: textGlitch 0.1s infinite; line-height: 1.1;
}
.scatter-subtext { color: #fff; margin-top: 10px; font-size: 0.9em; opacity: 0.8; }

/* ================================================== */
/* === 7. INFO PANELS, BUTTONS, FOOTER === */
/* ================================================== */

#game-name-display-bottom { font-weight: bold; font-size: 1.1em; width: 100%; overflow: hidden; white-space: nowrap; box-sizing: border-box; }
@keyframes marquee-scroll { from { transform: translateX(0); } to { transform: translateX(-100%); } }
@keyframes animated-text-gradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
.scrolling-text { display: inline-block; padding-left: 100%; background: linear-gradient(to right, #ffd700, #ff8c00, var(--primary-red), #ffd700); background-size: 200% auto; color: transparent; -webkit-background-clip: text; background-clip: text; animation: marquee-scroll 8s linear infinite, animated-text-gradient 3s linear infinite; }

.gif-container { display: flex; justify-content: center; align-items: center; }
.gif-frame { width: 120px; position: relative; border-radius: 10px; overflow: hidden; background-color: #000; }
.gif-frame::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: conic-gradient( transparent, transparent, transparent, var(--primary-red), transparent ); animation: led-border-spin 2.5s linear infinite; }
@keyframes led-border-spin { 100% { transform: rotate(360deg); } }
.gif-frame-inner { position: relative; inset: 3px; background: #000; border-radius: 8px; z-index: 2; }
.gif-frame-inner img { width: 100%; height: auto; display: block; border-radius: 8px; }

@keyframes energy-pulse { 0%, 100% { box-shadow: 0 0 8px #ffc300, 0 0 4px #ffc300 inset; } 50% { box-shadow: 0 0 16px #ff8c00, 0 0 8px #ff8c00 inset; } }
.energy-separator { width: 90%; height: 2px; background: linear-gradient(90deg, transparent, #ffc300, var(--primary-red), #ffc300, transparent); border-radius: 2px; margin: 0 auto; animation: energy-pulse 2s infinite ease-in-out; }

.analysis-info-panel { display: flex; border: 1px solid rgba(217,4,41,.5); background: rgba(217,4,41,.1); padding: 10px; animation: pulse-panel 4s infinite ease-in-out; position: relative; overflow: hidden; margin: 0 auto; width: 100%; max-width: 350px; box-sizing: border-box; }
@keyframes scan-line-vertical { 0% { top: -10%; } 100% { top: 110%; } }
.scan-effect-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }
.scan-effect-overlay::before { content: ''; position: absolute; left: 0; width: 100%; height: 2px; background: linear-gradient(to right, transparent, var(--primary-red), transparent); box-shadow: 0 0 10px var(--primary-red); animation: scan-line-vertical 3s ease-in-out infinite; animation-delay: 1s; }

.info-boxes-area { width: 100%; display: flex; flex-direction: column; gap: 8px; z-index: 1; }
@keyframes animated-gradient-flow { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
.led-info-box { position: relative; background: transparent; border: none; border-radius: 6px; padding: 10px; text-align: center; display: flex; flex-direction: column; z-index: 1; }
.led-info-box::before { content: ''; position: absolute; z-index: -1; top: 2px; left: 2px; right: 2px; bottom: 2px; background: rgba(0,0,0,.8); border-radius: 4px; }
.led-info-box::after { content: ''; position: absolute; z-index: -2; top: 0; left: 0; right: 0; bottom: 0; border-radius: 6px; background: linear-gradient(60deg, #ffd700, #ff8c00, var(--primary-red), #ffd700); background-size: 300% 300%; animation: animated-gradient-flow 4s linear infinite; transition: all .5s ease; }
.led-info-box span, .led-info-box small { font-weight: bold; }
.led-info-box small { color: #ccc; font-size: .75em; }
.led-info-box span { text-transform: uppercase; font-size: .9em; color: #ffd700; text-shadow: 0 0 8px #ffd700; }
.led-info-box.result-highlight::after { background: linear-gradient(60deg, #a2ff00, #00ffc3, #ffd500, #a2ff00); background-size: 300% 300%; animation-duration: 2s; }
.led-info-box.result-highlight span { color: #fff; text-shadow: 0 0 8px #a2ff00; }
.led-info-box.result-highlight small { color: #fff; }
.led-info-box.result-reveal { animation: result-pop-in .5s ease-out forwards; }
@keyframes result-pop-in { from { opacity: 0; transform: scale(.8); } to { opacity: 1; transform: scale(1); } }

/* Buttons & Footer */
#analyze-button { width: 100%; padding: 15px; font-size: 1.2em; position: relative; overflow: hidden; z-index: 1; border-radius: 12px; animation: button-pulse 2s infinite ease-in-out; background: linear-gradient(45deg, #a40606, var(--primary-red)); }
@keyframes button-pulse { 0% { box-shadow: 0 0 10px rgba(217,4,41,.5); } 50% { box-shadow: 0 0 25px rgba(217,4,41,.9); } 100% { box-shadow: 0 0 10px rgba(217,4,41,.5); } }
#analyze-button::after { content: ''; position: absolute; top: 0; left: -150%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,.4), transparent); transform: skewX(-25deg); transition: 0s; }
#analyze-button:hover::after { left: 150%; transition: .8s ease; }
#analyze-button:hover { transform: translateY(-3px); box-shadow: 0 0 30px rgba(217,4,41,1); animation-play-state: paused; }

#analysis-progress-container { width: 100%; text-align: center; padding: 10px 0; }
.progress-status-text { color: #ffd700; font-size: .9em; margin-bottom: 10px; text-shadow: 0 0 5px #ffd700; height: 30px; line-height: 1.5; }
.progress-bar-wrapper { width: 100%; height: 30px; background-color: #000; border: 2px solid var(--primary-red); border-radius: 8px; position: relative; overflow: hidden; box-shadow: 0 0 15px rgba(217,4,41,.5) inset; }
.progress-bar-fill { width: 0%; height: 100%; border-radius: 6px; background: linear-gradient(90deg, #ffd700, var(--primary-red)); transition: width .2s linear; position: relative; overflow: hidden; }
.progress-bar-fill::after { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(-45deg, rgba(255,255,255,0) 0%, rgba(255,255,255,.3) 40%, rgba(255,255,255,.3) 60%, rgba(255,255,255,0) 100%); background-size: 50px 50px; animation: progress-scan 1s linear infinite; opacity: .5; }
@keyframes progress-scan { from { background-position: 0 0; } to { background-position: 50px 0; } }
.progress-bar-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); color: #fff; font-weight: bold; text-shadow: 0 0 5px #000; }

#end-button { width: 100%; margin-top: 15px; padding: 12px; background: rgba(20, 0, 0, 0.6); border: 1px solid #555; color: #888; font-family: 'Poppins', sans-serif; font-weight: 700; text-transform: uppercase; cursor: pointer; border-radius: 10px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); display: flex; justify-content: center; align-items: center; gap: 10px; backdrop-filter: blur(4px); position: relative; overflow: hidden; }
#end-button:hover { border-color: #ff3333; color: #fff; background: rgba(255, 0, 0, 0.15); box-shadow: 0 0 15px rgba(255, 0, 0, 0.6), inset 0 0 10px rgba(255, 0, 0, 0.2); transform: translateY(-2px); letter-spacing: 1px; }
#end-button:active { transform: scale(0.98); box-shadow: 0 0 5px rgba(255, 0, 0, 0.8); }
#end-button svg { width: 18px; height: 18px; fill: currentColor; transition: transform 0.3s ease; }
#end-button:hover svg { transform: rotate(90deg); }

#custom-confirm-modal { display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); backdrop-filter: blur(5px); justify-content: center; align-items: center; animation: fadeIn 0.2s ease-out; }
.confirm-box-content { background: linear-gradient(135deg, #1a0505, #000); border: 1px solid #ff3333; box-shadow: 0 0 30px rgba(255, 0, 0, 0.3), inset 0 0 20px rgba(255, 0, 0, 0.1); padding: 30px; border-radius: 16px; width: 90%; max-width: 400px; text-align: center; transform: scale(0.9); animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
@keyframes popIn { to { transform: scale(1); opacity: 1; } }
.confirm-box-content h3 { color: #ff3333; font-family: 'Poppins', sans-serif; margin-top: 0; text-transform: uppercase; font-size: 1.4em; text-shadow: 0 0 10px rgba(255, 0, 0, 0.5); }
.confirm-box-content p { color: #ccc; font-size: 1em; margin: 15px 0 25px; line-height: 1.5; }
.confirm-actions { display: flex; justify-content: center; gap: 15px; }
.btn-modal { padding: 10px 25px; border-radius: 8px; font-weight: bold; cursor: pointer; font-family: 'Roboto', sans-serif; transition: all 0.2s; border: none; }
.btn-cancel { background: #333; color: #fff; border: 1px solid #555; }
.btn-cancel:hover { background: #444; }
.btn-confirm { background: linear-gradient(45deg, #d90429, #ff3333); color: #fff; box-shadow: 0 0 10px rgba(217, 4, 41, 0.5); }
.btn-confirm:hover { transform: translateY(-2px); box-shadow: 0 0 20px rgba(217, 4, 41, 0.8); }

@keyframes lightning-flicker { 0%,100%{opacity:.2} 5%{opacity:.8} 8%{opacity:.3} 15%{opacity:1} 20%{opacity:.2} 30%{opacity:.9} 40%{opacity:.1} 50%{opacity:.8} 60%{opacity:.3} 70%{opacity:1} }
.lightning-field { position: absolute; top: 0; left: 0; width: 30%; height: 100%; }
.lightning-field.right { left: auto; right: 0; transform: scaleX(-1); }
.lightning-container { position: absolute; }
.lightning-svg { width: 100%; height: auto; filter: drop-shadow(0 0 8px currentColor); animation: lightning-flicker 1.2s linear infinite; }
.lightning-container:nth-child(1) { width: 40px; top: 50%; left: 50%; transform: translate(-50%,-50%); animation-delay: -.1s; color: #ffd700; }
.lightning-container:nth-child(2) { width: 25px; top: 15%; left: 80%; transform: translate(-50%,-50%) rotate(15deg); animation-duration: .8s; animation-delay: -.5s; color: var(--primary-red); }
.lightning-container:nth-child(3) { width: 30px; top: 85%; left: 30%; transform: translate(-50%,-50%) rotate(-10deg); animation-duration: 1.5s; animation-delay: -.8s; color: #ffd700; }
@keyframes rain-fall { from { transform: translateY(-50px); opacity: 1; } to { transform: translateY(100vh); opacity: 0; } }
#particle-field { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
#particle-field > .particle { position: absolute; top: 0; width: 2px; background: linear-gradient(to bottom, currentColor, transparent); animation: rain-fall linear infinite; filter: drop-shadow(0 0 6px currentColor); }

/* ================================================== */
/* === MOBILE & TABLET MEDIA QUERIES === */
/* ================================================== */

@media (max-width: 480px) {
    .analysis-main { align-items: flex-start; padding: 10px; }
    .analysis-frame { height: auto; min-height: 95vh; margin-top: 10px; width: 100%; max-width: none; }
    .analysis-content { justify-content: flex-start; gap: 20px; }
    .main-game-display { width: 120px; height: 120px; }
    #robot-image { max-width: 70px; }
    
    /* Mobile: Giữ size khung tròn 80px */
    .progress-frame-container { width: 80px; height: 80px; }
    .progress-frame-value { font-size: 1.3em; } 
    
    .gif-frame { width: 100px; }
    .led-info-box { padding: 8px; }
    .led-info-box span { font-size: .8em; }
    .scanner-1 { top: 40px; left: 65px; width: 55px; transform: rotate(-40deg); }
    .scanner-2 { top: 60px; left: 65px; width: 65px; transform: rotate(-10deg); }
    .scanner-3 { top: 80px; left: 65px; width: 55px; transform: rotate(20deg); }
    .scan-impact-ripple { top: 0; left: 0; width: 100%; height: 100%; }
}

/* ================================================================= */
/* === 8. SLOT SPECIFIC UI (GIAO DIỆN RIÊNG CHO TRANG NỔ HŨ) === */
/* ================================================================= */

#slot-specific-ui .slot-dashboard-layout { display: flex; flex-direction: column; gap: 15px; margin-top: 10px; width: 100%; }
#slot-specific-ui .slot-row-top { display: flex; justify-content: space-between; align-items: center; height: 120px; position: relative; }
#slot-specific-ui .slot-col-left { flex: 0 0 90px; display: flex; justify-content: center; align-items: center; z-index: 2; }
#slot-specific-ui .slot-col-right { flex: 0 0 120px; display: flex; justify-content: center; align-items: center; z-index: 2; }
#slot-specific-ui .slot-col-center { flex: 1; display: flex; justify-content: center; align-items: center; position: relative; z-index: 10; height: 100%; }

/* Mobile cho Slot: Cân chỉnh lại */
#slot-specific-ui .progress-frame-container { 
    margin: 0; 
}

#slot-specific-ui .robot-container { width: auto; text-align: center; display: flex; justify-content: center; align-items: center; margin: 0; }
#slot-specific-ui #robot-image { max-width: 130px; animation: bot-float 3s infinite ease-in-out; margin-top: 10px; }
#slot-specific-ui .gif-frame { width: 100%; }
#slot-specific-ui .gif-frame::before { animation: none; border: 1px solid var(--primary-red); }

#slot-specific-ui .slot-row-middle { display: flex; justify-content: space-between; align-items: stretch; gap: 10px; height: 120px; background: rgba(0,0,0,0.3); border: 1px solid rgba(217, 4, 41, 0.3); border-radius: 10px; padding: 8px; position: relative; }
#slot-specific-ui .slot-game-image-box { width: 45%; position: relative; background: rgba(0, 0, 0, 0.5); border: 1px solid rgba(255, 0, 0, 0.5); box-shadow: 0 0 15px rgba(255, 0, 0, 0.2), inset 0 0 20px rgba(255, 0, 0, 0.1); border-radius: 12px; padding: 4px; overflow: hidden; }
#slot-specific-ui .glitch-wrapper { width: 100%; height: 100%; border-radius: 8px; border: none; position: relative; }
#slot-specific-ui #panel-game-image { width: 100%; height: 100%; object-fit: cover; border-radius: 8px; }
#slot-specific-ui .glitch-layer { border-radius: 8px; }
#slot-specific-ui .scan-impact-ripple { border-radius: 8px; }

#slot-specific-ui .slot-scanner-box { width: 55%; position: relative; background: rgba(40, 0, 0, 0.6); border-radius: 8px; overflow: hidden; display: flex; align-items: center; justify-content: center; border: 1px solid rgba(255, 0, 0, 0.3); box-shadow: inset 0 0 15px rgba(255, 0, 0, 0.2); }
#slot-specific-ui .scanner-lines { width: 100%; height: 100%; position: relative; display: flex; flex-direction: column; justify-content: space-evenly; padding: 5px; }
#slot-specific-ui .scan-line-item { height: 2px; background: linear-gradient(90deg, transparent, #ff0000, transparent); width: 100%; opacity: 0.7; box-shadow: 0 0 8px #ff0000; }
#slot-specific-ui .scan-line-item.s1 { animation: scan-move 2s infinite ease-in-out; width: 80%; align-self: center; }
#slot-specific-ui .scan-line-item.s2 { animation: scan-move 2s infinite ease-in-out 0.3s; width: 60%; align-self: flex-start; margin-left: 10%; }
#slot-specific-ui .scan-line-item.s3 { animation: scan-move 2s infinite ease-in-out 0.6s; width: 90%; align-self: center; }
@keyframes scan-move { 0%, 100% { opacity: 0.3; transform: scaleX(0.8); } 50% { opacity: 1; transform: scaleX(1); box-shadow: 0 0 15px #ff0000; } }
#slot-specific-ui .scan-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #ff3333; font-size: 0.9em; font-family: monospace; letter-spacing: 2px; font-weight: bold; animation: blink-text 1s infinite; text-shadow: 0 0 8px #ff0000; z-index: 2; }
@keyframes blink-text { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

.post-hack-content { width: 100%; height: 100%; padding: 10px; display: flex; flex-direction: column; justify-content: center; gap: 5px; font-family: 'Courier New', monospace; animation: fadeInResult 0.5s ease-out; }
.hack-item { font-size: 0.75em; color: #ccc; display: flex; justify-content: space-between; border-bottom: 1px dashed rgba(255,0,0,0.3); padding-bottom: 2px; }
.hack-item span { font-weight: bold; text-shadow: 0 0 5px currentColor; }
.hack-status { margin-top: 5px; text-align: center; color: #ffd700; font-weight: bold; font-size: 0.9em; border: 1px solid #ffd700; padding: 2px; border-radius: 4px; background: rgba(255, 215, 0, 0.1); animation: pulse-status 1s infinite; }
@keyframes pulse-status { 0%, 100% { opacity: 1; box-shadow: 0 0 5px #ffd700; } 50% { opacity: 0.7; box-shadow: 0 0 2px #ffd700; } }

@media (max-width: 480px) {
    #slot-specific-ui .slot-row-top { height: 100px; }
    #slot-specific-ui #robot-image { max-width: 80px; }
    
    /* Mobile Slot specific override */
    #slot-specific-ui .progress-frame-container { 
        width: 80px; 
        height: 80px; 
    }
    #slot-specific-ui .progress-frame-value { font-size: 1.4em; }
    
    #slot-specific-ui .gif-frame { width: 80px; }
    
    #slot-specific-ui .slot-col-left, #slot-specific-ui .slot-col-right { flex: 0 0 60px; }
    #slot-specific-ui .slot-row-middle { height: 100px; }
    .hack-item { font-size: 0.7em; }
    .hack-status { font-size: 0.8em; }
}
/* --- SỬA ĐỔI: CSS CHO ẢNH POPUP SCATTER/BOSS --- */

/* Class mới cho ảnh thay vì icon chữ */
.scatter-icon-img {
    width: 120px;            /* Kích thước ảnh */
    height: auto;
    margin-bottom: 15px;
    filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.6)); /* Hiệu ứng tỏa sáng vàng */
    animation: bounceIcon 1.5s infinite ease-in-out;      /* Hiệu ứng nảy */
    display: block;
    margin-left: auto;
    margin-right: auto;
}

/* Giữ nguyên animation cũ nhưng chỉnh lại chút cho mượt với ảnh */
@keyframes bounceIcon { 
    0%, 100% { transform: translateY(0) scale(1); } 
    50% { transform: translateY(-15px) scale(1.1); } 
}