<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
     <title>IronxSlot - B·∫£ng ƒêi·ªÅu Khi·ªÉn</title>
    <link rel="icon" type="image/png" href="/assets/images/favicon.png">
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/admin.css">
    <link rel="manifest" href="/manifest.json">
</head>
<script>
    // === B·∫ÆT BU·ªòC KI·ªÇM TRA ƒêƒÇNG NH·∫¨P ===
    if (!localStorage.getItem('username')) {
        window.location.href = '/'; // Chuy·ªÉn v·ªÅ trang ƒëƒÉng nh·∫≠p
    }
</script>
<body class="admin-page">
    <header class="header fadeIn">
        <div></div> 
        <div class="header-right-group">
            <div id="admin-coin-display">Token: ...</div>
            <button class="logout-button">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                <span>ƒêƒÉng Xu·∫•t</span>
            </button>
        </div>
    </header>

    <main class="fadeIn admin-main-container">
        <h1>B·∫£ng ƒêi·ªÅu Khi·ªÉn Admin</h1>
        
        <div class="grid-container" style="margin-top: 50px;">
            <!-- Menu n√†y ch·ªâ Super Admin m·ªõi th·∫•y -->
            <a href="/super_admin_manage_admins.html" class="admin-menu-card" id="manage-admins-menu" style="display: none;">
                <div class="icon">
                   <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
               </div>
               <h3>Qu·∫£n L√Ω Admin</h3>
               <p>T·∫°o v√† c·∫•p Token cho c√°c t√†i kho·∫£n Admin ph·ª•.</p>
           </a>

            <!-- Menu n√†y t·∫•t c·∫£ Admin ƒë·ªÅu th·∫•y -->
            <a href="/admin_users.html" class="admin-menu-card">
                 <div class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                </div>
                <h3>Qu·∫£n L√Ω User</h3>
                <p>C·∫•p Token v√† qu·∫£n l√Ω t√†i kho·∫£n ng∆∞·ªùi d√πng.</p>
            </a>

            <!-- === C·∫¨P NH·∫¨T: Thay ƒë·ªïi th·∫ª <a> th√†nh <div> ƒë·ªÉ k√≠ch ho·∫°t popup === -->
            <div class="admin-menu-card" id="manage-games-menu" style="display: none; cursor: pointer;" onclick="openGameCategoryModal()">
                <div class="icon">
                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>
                </div>
                <h3>Qu·∫£n L√Ω Game</h3>
                <p>T·∫°o s·∫£nh game v√† th√™m c√°c tr√≤ ch∆°i.</p>
            </div>
        </div>
    </main>

    <!-- === TH√äM M·ªöI: Popup l·ª±a ch·ªçn lo·∫°i game ƒë·ªÉ qu·∫£n l√Ω === -->
    <div id="gameCategoryModal" class="modal">
        <div class="modal-content fadeIn">
            <span class="close-btn" onclick="closeGameCategoryModal()">&times;</span>
            <h2>Ch·ªçn Lo·∫°i Game ƒë·ªÉ Qu·∫£n l√Ω</h2>
            <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 20px;">
                <button class="btn-primary" onclick="window.location.href='/admin_games.html'">üé∞ Qu·∫£n l√Ω N·ªï H≈©</button>
                <button class="btn-primary" onclick="window.location.href='/admin_games_fish.html'">üê† Qu·∫£n l√Ω B·∫Øn C√°</button>
            </div>
        </div>
    </div>

    <script>
        const gameCategoryModal = document.getElementById('gameCategoryModal');

        function openGameCategoryModal() {
            gameCategoryModal.style.display = 'flex';
        }

        function closeGameCategoryModal() {
            gameCategoryModal.style.display = 'none';
        }

        async function fetchAdminInfo() {
            const username = localStorage.getItem('username');
            const coinDisplay = document.getElementById('admin-coin-display');
            if (localStorage.getItem('isSuperAdmin') === 'true' || !coinDisplay) {
                if(coinDisplay) coinDisplay.style.display = 'none';
                return;
            };

            const response = await fetch(`/api/user-info?username=${username}`);
            const data = await response.json();
            if (data.success) {
                coinDisplay.textContent = `Token c√≤n l·∫°i: ${data.userInfo.coins}`;
            }
        }

        window.onload = () => {
            const isSuperAdmin = localStorage.getItem('isSuperAdmin') === 'true';

            if (isSuperAdmin) {
                document.getElementById('manage-admins-menu').style.display = 'block';
                document.getElementById('manage-games-menu').style.display = 'block';
            }
            
            fetchAdminInfo();
        };

        window.onclick = (event) => {
            if (event.target == gameCategoryModal) {
                closeGameCategoryModal();
            }
        }

        document.querySelector('.logout-button').addEventListener('click', () => {
            localStorage.clear();
            window.location.href = '/';
        });
    </script>
    <script src="/js/global.js"></script>
</body>
</html>